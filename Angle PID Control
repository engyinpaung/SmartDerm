from simple_pid import PID
import time
import matplotlib.pyplot as plt

#Initialize Kp, Ki and Kd values
Kp = 10
Ki = 10
Kd = 10

#Define Smartderm Class
class smartderm:
    def __init__(self):
        self.angle = 0
    def update(self, control,dt):
        if control > 0:
            self.angle += 0.5*dt #Revise this with Smartderm team
        else:
            self.angle -= 30*dt
        return self.angle
if __name__ == '__main__':
    sys = smartderm()
    angle = sys.angle
    pid = PID(Kp, Ki, Kd, setpoint = 30) #Set up PID control, might have to define a negative/positive value for L & R
    pid.output_limits = (-30, 30)
    start_time = time.time()
    last_time = start_time
    setpoint, t, omega = [], [], []
    for i in range (0,1000,1):
        pid.setpoint = 30
        current_time = time.time()
        dt = (current_time - last_time)
        control = pid(angle) #Figure out what this does
        angle = sys.update(control,dt)
        # Visualize Output Results
        t += [current_time - start_time] #create list for time variable
        omega += [angle] #create list for temperature variable
        setpoint += [pid.setpoint] #create setpoint constant
        # Used for initial value assignment of variable temp
        last_time = current_time

    # Visualization of Output Results
    plt.plot(t, setpoint, label='target')
    plt.plot(t, omega, label='PID')
    plt.xlabel('time')
    plt.ylabel('angle')
    plt.legend()
    plt.show()
